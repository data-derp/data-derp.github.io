---
sidebar_position: 2
---

# SQL: A Quick Review
When working with data, a solid knowledge of SQL is required to help think about your problem in terms of DataFrame transformations.

<div style={{textAlign: 'center'}}>

![sql-joins.png](./assets/sql-joins.png)

</div>

Have a quick scan through the topics that you're not too familiar with:
* [Joins](https://www.w3schools.com/sql/sql_join.asp) and [Unions](https://www.w3schools.com/sql/sql_union.asp)
* [Aggregate Functions (GROUP BY)](https://www.w3schools.com/sql/sql_groupby.asp)
* [Window Functions](https://mode.com/sql-tutorial/sql-window-functions/)
* What’s so great about them anyways? (See next slide)
* [Indexes & Query Plans](https://www.khanacademy.org/computing/computer-programming/sql/relational-queries-in-sql/a/more-efficient-sql-with-query-planning-and-optimization)

## A Deep Dive on Window Functions

<div style={{textAlign: 'center'}}>

![current-row.png](./assets/current-row.png)

</div>

* What limitations have you faced in your analytics when using GROUP BY in the past?
* How can you do rankings per each category efficiently?
* How can you get the entire row of the best-selling product? (imagine you want to see additional attributes of this product)

<div style={{textAlign: 'center'}}>

![window-function-usage.png](./assets/window-function-usage.png)

</div>

It is important to make sure you understand everything about window function semantics.

* partitionBy
    * similar to `groupBy` (but doesn’t reduce/aggregate information down to a single row)
* orderBy
    * Just FYI, you can `orderBy(F.col(“myColumn”).desc())` for descending order.
* rowsBetween
    * You should look up the default arguments for different window functions (e.g. lag, lead, first, last, max, min, row_number)
* rangeBetween
  Can you explain the difference between rowsBetween and rangeBetween?

These are [all also concepts in SQL and not special to Spark](https://towardsdatascience.com/a-guide-to-advanced-sql-window-functions-f63f2642cbf9).

## Exercise: Windows
The next exercises uses Windows for several critical sections and we find that people are more successful in completing the exercises if they are familiarised with Windows. Follow the instructions here for the [Windows Walkthrough](https://github.com/data-derp/small-exercises/tree/master/window-functions).